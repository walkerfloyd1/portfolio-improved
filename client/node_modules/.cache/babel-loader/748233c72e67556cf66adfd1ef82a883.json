{"ast":null,"code":"var tick = 1;\nvar maxTick = 65535;\nvar resolution = 4;\n\nvar inc = function () {\n  tick = tick + 1 & maxTick;\n};\n\nvar timer = setInterval(inc, 1000 / resolution | 0);\nif (timer.unref) timer.unref();\n\nmodule.exports = function (seconds) {\n  var size = resolution * (seconds || 5);\n  var buffer = [0];\n  var pointer = 1;\n  var last = tick - 1 & maxTick;\n  return function (delta) {\n    var dist = tick - last & maxTick;\n    if (dist > size) dist = size;\n    last = tick;\n\n    while (dist--) {\n      if (pointer === size) pointer = 0;\n      buffer[pointer] = buffer[pointer === 0 ? size - 1 : pointer - 1];\n      pointer++;\n    }\n\n    if (delta) buffer[pointer - 1] += delta;\n    var top = buffer[pointer - 1];\n    var btm = buffer.length < size ? 0 : buffer[pointer === size ? 0 : pointer];\n    return buffer.length < resolution ? top : (top - btm) * resolution / buffer.length;\n  };\n};","map":null,"metadata":{},"sourceType":"script"}